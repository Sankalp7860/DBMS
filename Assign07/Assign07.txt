
-- Q1 

CREATE VIEW temp_salesPerson as
SELECT a.S_NAME,b.* from SALES_PEOPLE as a,(SELECT S_NUM,AVG(AMT),SUM(AMT) from ORDERS GROUP BY S_NUM) as b 
WHERE a.S_NUM=b.S_NUM;

SELECT * from temp_salesPerson;

-- Q2 

CREATE OR REPLACE VIEW MULTIPLE_CUSTOMERS AS
SELECT s.S_NUM, s.S_NAME, COUNT(c.C_NUM) AS Customer_Count
FROM SALES_PEOPLE s
JOIN CUSTOMERS c ON s.S_NUM = c.S_NUM
GROUP BY s.S_NUM, s.S_NAME
HAVING COUNT(c.C_NUM) > 1;


SELECT * FROM MULTIPLE_CUSTOMERS;

-- Q3 

SELECT sp.S_NAME AS Salesperson_Name, c.C_NAME AS Customer_Name, c.CITY
FROM SALES_PEOPLE sp
INNER JOIN CUSTOMERS c ON sp.CITY = c.CITY AND sp.S_NUM = c.S_NUM;

-- Q4 

SELECT sp.S_NAME AS Salesperson_Name, sp.COMM AS Commission
FROM SALES_PEOPLE sp
INNER JOIN ORDERS o ON sp.S_NUM = o.S_NUM
INNER JOIN CUSTOMERS c ON sp.CITY = c.CITY AND sp.S_NUM = c.S_NUM
GROUP BY sp.S_NAME,SP.COMM
HAVING COUNT(o.O_NUM) > 3;

-- Q5 

SELECT s.S_NUM, s.S_NAME, s.CITY, c.C_NUM, c.C_NAME, c.CITY
FROM SALES_PEOPLE s
CROSS JOIN CUSTOMERS c;

-- Q6 

SELECT sp.S_NAME AS Salesperson_Name, c.C_NAME AS Customer_Name, c.CITY
FROM SALES_PEOPLE sp
INNER JOIN CUSTOMERS c ON sp.S_NUM = c.S_NUM;

-- Q7 

CREATE TABLE SALES_PEOPLE (
    S_NUM INT PRIMARY KEY,
    S_NAME VARCHAR(50) CHECK (S_NAME >= 'A' AND S_NAME <= 'M'),
    CITY VARCHAR(50),
    COMM DECIMAL(5,2) NOT NULL DEFAULT 0.10
);

-- Q8 

CREATE TABLE ORDERS (
    O_NUM INT PRIMARY KEY,
    AMT DECIMAL(10,2) NOT NULL,
    ORDER_DATE DATE,
    C_NUM INT NOT NULL CHECK (O_NUM > C_NUM),
    S_NUM INT NOT NULL CHECK (C_NUM > S_NUM)
);